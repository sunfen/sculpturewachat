<!--index.wxml-->
<component-topnav inner-title="记工统计" is-show-back="true"></component-topnav>  

<page>
  <view class="container">
    <view class="content">
      <!-- 搜索 -->
      <!-- <view class="query">
        <view>
         <button class='query-button'  bindtap="query">搜索</button>
        </view>
        <view>起止时间:2018年12月23日-2019年23月34日</view> 
      </view>-->
    
      <!-- tab -->
      <view class="swiper-tab">
          <view class="swiper-tab-item {{currentTab==0?'active':''}}" data-current="0" bindtap="clickTab">按项目查看</view>
    <view class="swiper-tab-item {{currentTab==1?'active':''}}" data-current="1" bindtap="clickTab">按人名查看</view>
      </view>
      
      <!-- 按项目查看 -->
      <view wx:if="{{currentTab == 0}}">
        <!-- table header -->
        <view class="table-header">
          <text>项目名称</text>
          <text>明细</text>
          <text>金额</text>
        </view>
        <!-- table body -->
        <scroll-view class="table-body">
         
          <view class="touch-item" wx:for="{{results}}" wx:key="property" wx:for-item="item" wx:for-index="id"  data-index="{{id}}" bindlongtap='handleLongPress' bindtouchstart="touchstart" bindtouchmove="touchmove" >
              <view class="table-body-left">
                <text style='font-weight:600'>{{item.name}}</text>
                <text wx:if="{{item.startTime}}">始：{{item.startTime}}</text>
                <text style="color:red;" wx:else="{{item.startTime}}">未开始</text>
                <text wx:if="{{item.endTime}}">完：{{item.endTime}}</text>
              </view>
              
              <view class="table-body-center">
                <text>上班: {{item.works}}</text>
                <text>加班: {{item.extraWorks}}</text>
              </view>
              
              <view class="table-body-right">
                <text>工资：{{item.expectTotalWages}}元</text>
                <text>已结算：{{item.actualTotalWages}}元</text>
              </view>
          </view>

        </scroll-view>
      </view>

      
      <!-- 按负责人查看 -->
      <view wx:if="{{currentTab == 1}}">
        <!-- table header -->
        <view class="table-header">
          <text>负责人</text>
          <text>项目数</text>
          <text>项目名</text>
        </view>
        <!-- table body -->
        <scroll-view class="table-body">
          
          <view class="table-body-row-principal"  wx:for="{{results}}" wx:key="property" wx:for-item="item" wx:for-index="id">
            
            <view class="table-body-left-principal">{{item.principal}}</view>
            <view class="table-body-left-principal">{{item.total}}</view>
            
            <view class="table-body-center-principal" wx:if="{{item.projects.length > 0 }}" >
              <view  wx:for="{{item.projects}}" wx:key="property" wx:for-item="project" wx:for-index="id">
                <text>{{project.name}}(</text>
                <text wx:if="{{project.startTime}}">{{project.startTime}}</text>
                <text  style="color:red;" wx:else="{{project.startTime}}">未开始</text>
                <text>)</text>
              </view>
            </view>
            <view class="table-body-center-principal" wx:else="{{item.projects.length > 0 }}" >
              <view></view>
            </view>
          </view>

        </scroll-view>
      </view>


    </view>
  </view>
</page>