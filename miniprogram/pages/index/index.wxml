<!--index.wxml-->
<component-topnav></component-topnav>  
<scroll-view>

  <!-- 便利贴开始 -->
  <view class="note">
    <view class="note-content" wx:if="{{project.id}}" >
      <!-- 添加项目人 -->
      <view class="note-title">
        <icon  class="iconfont icon-new"></icon>
      </view>
      
        <view class="note-content-detail"  bindtap='viewdetail'>
          
          <view class="note-column-name">
            <view><text>名称：</text><text class="note-column-name-name">{{project.name}}</text></view>
            <view>地点：{{project.address}}</view>
          </view>
  
          <!-- 项目时间 -->
          <view class="note-column-date">
            <text wx:if="{{project.startTime}}">工期：{{project.startTime}}<text wx:if="{{project.endTime}}"> — {{project.endTime}}</text></text>
            <text wx:else="{{project.startTime}}">未开始</text>
            
            <text>每天均收入<text style="color:rgb(235, 96, 42);font-weight:600">{{project.dailyWages}}</text>元</text>
          </view>
          

          <view class="note-column-wages">
            <progress percent="{{project.actualTotalWages/project.expectTotalWages}}" color="#D84339" backgroundColor="#B5AEAD" border-radius="3"/> 
            <text decode='true'>已结{{project.actualTotalWages}}元 共{{project.expectTotalWages}}元</text>
          </view>
      
        </view>
        
          
    </view>
    <view wx:else="{{project.id}}"  class="note-content-detail">暂无</view>
  </view>
<!-- 便利贴结束 -->


  <!-- 身份切换 -->
  <view class="top-center">
  
    <view class="top-one">
      <text class="top-one-top">{{monthWages ? monthWages : 0}}元</text>
      <text>本月收入</text>
    </view>
  
    <view class="top-one">
      <text class="top-one-top">{{workDays ? workDays : 0}}天</text>
      <text>本月出勤天数</text>
    </view>

    <view class="top-one">
      <text class="top-one-top">{{extraDays ? extraDays : 0}}天</text>
      <text>本月加班天数</text>
    </view>

    <view class="top-one">
      <text class="top-one-top">{{leaveDays ? leaveDays : 0}}天</text>
      <text>本月缺勤天数</text>
    </view>
  
  </view>

<!-- top结束 -->

<view class="blank-space"></view>
   <!-- 功能 -->
<view class="function">
    <view class="function-sign">
     <form bindsubmit='addLogToday' class="img-plus-style "  report-submit='true'>
      <button form-type='submit'  class="defalut_btn">
        <icon class="iconfont icon-sign"></icon>
      </button>
     </form>
    </view>

    <!-- 打卡记录 -->
    <form bindsubmit='addOrUpdateLog' report-submit='true'>
      <view class="function-remind">
        <view class="function-remind-icon">
          <icon class="iconfont icon-edit-account"></icon>
        </view>
        <button form-type='submit'  class="defalut_btn function-remind-right">
          <text>打卡记录</text>
          <view  class="function-help-right-record ">
              <icon class="iconfont icon-back-right"></icon>
          </view>     
        </button>  
      </view>  
    </form>
    
    <!-- 结工资 -->
    <form bindsubmit='addWage' report-submit='true'>
      <view class="function-remind">
        <view class="function-remind-icon">
          <icon class="iconfont icon-wages"></icon>
        </view>
        <button form-type='submit' class="defalut_btn function-remind-right">
          <text>结工资</text>
          <view class="function-help-right">
            <icon class="iconfont icon-back-right"></icon> 
          </view>
        </button>
      </view>
    </form>
    
    
    
    <!-- 统计 -->
    <form bindsubmit='viewStatistics' report-submit='true'>
      <view class="function-remind">
        <view class="function-remind-icon">
            <icon class="iconfont icon-statistics"></icon>
        </view>
        <button form-type='submit'  class="defalut_btn function-remind-right">
          <text>统计</text>
          <view  class="function-help-right">
              <icon class="iconfont icon-back-right"></icon>
          </view>
        </button>
      </view>
    </form>

  </view>
  
  <form bindsubmit='addProject' report-submit='true'>
    <button form-type='submit' type="primary" style='width:50%;margin-top:20px'>新增项目</button>
  </form>


  <view class="container">
    <!--屏幕背景变暗的背景  -->
    <view class="commodity_screen" bindtap="hideModal" wx:if="{{showModalStatus}}"></view>
    
    <!--弹出框  -->
    <view animation="{{animationData}}" class="commodity_attr_box" wx:if="{{showModalStatus}}">
      <view class="commodity-button">
        <view class="commodity-button-title"><text>选择 <text class="commodity-button-title-middle">今日</text> 工作时长</text></view>

        <view class="commodity-button-content">
          <view wx:for="{{selectTypes}}" wx:key="property"  wx:for-item="item" wx:for-index="index">
            
            <view  wx:if="{{item.property == 'record.morningHour'}}">
              
              <view class="row-right">
                
                <text class="row-right-type"><text>{{item.name}}</text> -> 选择项目：</text>
                
                <picker style='z-index:1000000' bindchange="bindProjectChange" range="{{projects}}" range-key="name" value="{{record.morningProjectIndex}}"  data-project="record.morningProject"  data-project-id="record.morningProjectId"   data-project-index="record.morningProjectIndex">
                 
                    <view class="table-item-top"> 
                 
                      <text wx:if="{{projects[record.morningProjectIndex].principal}}">{{projects[record.morningProjectIndex].principal}} - {{projects[record.morningProjectIndex].name}}</text>
                      <text wx:else>{{projects[record.morningProjectIndex].name}}</text>
                      <icon class="iconfont icon-back-right"></icon>
                    </view>
                </picker>   
              </view>
            
              <view class='commodity-hours' wx:if="{{projects[record.morningProjectIndex].name != '无'}}">
                <form bindsubmit='onSelectHours' report-submit='true' wx:for="{{item.hours}}" wx:key="property" wx:for-item="hour" wx:for-index="indexhour" data-hour='{{hour.data}}' data-property="{{item.property}}">
                  <button  form-type='submit' style="background:{{record.morningHour == hour.data ? COLOR_RED : COLOR_GRAY}};"  size='mini' >{{hour.name}}</button>
                </form>

              </view>

            </view>
            <!--循环-->
            <view  wx:if="{{item.property == 'record.afternoonHour'}}">
              
              <view class="row-right">
                
                <text class="row-right-type"><text>{{item.name}}</text> -> 选择项目：</text>
                
                <picker style='z-index:1000000' bindchange="bindProjectChange" range="{{projects}}" value="{{record.afternoonProjectIndex}}" range-key="name" data-project="record.afternoonProject"  data-project-id="record.afternoonProjectId"   data-project-index="record.afternoonProjectIndex">
                 
                  <view class="table-item-top"> 
                      <text wx:if="{{projects[record.afternoonProjectIndex].principal}}">{{projects[record.afternoonProjectIndex].principal}} - {{projects[record.afternoonProjectIndex].name}}</text>
                      <text wx:else>{{projects[record.afternoonProjectIndex].name}}</text>
                      <icon class="iconfont icon-back-right"></icon>
                  </view>
                </picker>   
              </view>
            
              <view class='commodity-hours'  wx:if="{{projects[record.afternoonProjectIndex].name != '无'}}">
                <form bindsubmit='onSelectHours' report-submit='true'  wx:for="{{item.hours}}" wx:key="property" wx:for-item="hour" wx:for-index="indexhour" data-hour='{{hour.data}}' data-property="{{item.property}}">
                <button form-type='submit' style="background:{{record.afternoonHour == hour.data ? COLOR_RED : COLOR_GRAY}};"  size='mini' >{{hour.name}}</button>
                </form>
              </view>

            </view>


            <view  wx:if="{{item.property == 'record.eveningHour'}}">
              
              <view class="row-right">
                <text class="row-right-type"><text>{{item.name}}</text> -> 选择项目：</text>
                
                <picker style='z-index:1000000' bindchange="bindProjectChange" range="{{projects}}" value="{{record.eveningProjectIndex}}" range-key="name"  data-project="record.eveningProject"  data-project-id="record.eveningProjectId"   data-project-index="record.eveningProjectIndex">
                
                  <view class="table-item-top"> 
                    <text wx:if="{{projects[record.eveningProjectIndex].principal}}">{{projects[record.eveningProjectIndex].principal}} - {{projects[record.eveningProjectIndex].name}}</text>
                    <text wx:else>{{projects[record.eveningProjectIndex].name}}</text>
                    <icon class="iconfont icon-back-right"></icon>
                  </view>
                
                </picker>   
           
              </view>
            
              <view class='commodity-hours'   wx:if="{{projects[record.eveningProjectIndex].name != '无'}}">
                <form bindsubmit='onSelectHours' report-submit='true'   wx:for="{{item.hours}}" wx:key="property" wx:for-item="hour" wx:for-index="indexhour" data-hour='{{hour.data}}' data-property="{{item.property}}">
                  <button form-type='submit' style="background:{{record.eveningHour == hour.data ? COLOR_RED : COLOR_GRAY}};"  size='mini' >{{hour.name}}</button>
                </form>
              </view>

            </view>


        </view>
          <!--循环结束-->
      </view>
    </view>

      <input bindinput="inputValue" data-id="record.remark" value="{{record.remark}}" placeholder='备注：点击填写今天的备注'></input>
      <!-- 按钮开始 -->
      <view class="commodity-bottom">
          <form bindsubmit='hideModal' report-submit='true' >
            <button form-type='submit'  class="defalut_btn">取消</button>
          </form>
          <form bindsubmit='save' report-submit='true'  class="commodity-bottom-sure">
            <button form-type='submit'  class="defalut_btn">确定</button>
          </form>
      </view>
      <!-- 按钮结束 -->

    </view>
  </view>

  <!-- 弹出框结束 -->
<component-footernav current="0"></component-footernav>  

</scroll-view>